<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="description"
        content="Masked Autoencoder with Inpainting results for Wallpaper Symmetry Group Learning - Testing reconstruction from partially masked inputs.">
    <meta name="keywords"
        content="Masked Autoencoder, Inpainting, Symmetry Learning, Wallpaper Groups, Deep Learning, Latent Space, Image Reconstruction">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Masked Autoencoder (Inpainting) — Wallpaper Symmetry Learning</title>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">
    <link rel="icon" href="./static/images/favicon.svg">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>
</head>

<body>

    <nav class="navbar" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
            <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        <div class="navbar-menu">
            <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
                <a class="navbar-item" href="index.html">
                    <span class="icon">
                        <i class="fas fa-home"></i>
                    </span>
                </a>

                <div class="navbar-item has-dropdown is-hoverable">
                    <a class="navbar-link">
                        Experiments
                    </a>
                    <div class="navbar-dropdown">
                        <a class="navbar-item" href="standard-ae.html">
                            Standard Autoencoder (Best Reconstruction)
                        </a>
                        <a class="navbar-item is-active" href="masked-ae.html">
                            Masked Autoencoder (Inpainting)
                        </a>
                        <a class="navbar-item" href="beta-05.html">
                            β = 0.5 (Reconstruction Focus)
                        </a>
                        <a class="navbar-item" href="beta-10.html">
                            β = 1.0 (Standard VAE)
                        </a>
                        <a class="navbar-item" href="beta-40.html">
                            β = 4.0 (Disentanglement Focus)
                        </a>
                        <a class="navbar-item" href="comparison.html">
                            Comparative Analysis
                        </a>
                    </div>
                </div>
            </div>

        </div>
    </nav>

    <!-- ==================== MASKED AUTOENCODER SECTION ==================== -->
    <section class="section" id="masked-ae">
        <div class="container is-max-desktop">
            <div class="columns is-centered">
                <div class="column is-full-width">
                    <h2 class="title is-2" style="border-bottom: 3px solid #ff6b35; padding-bottom: 10px;">
                        <span style="color: #ff6b35;">Masked Autoencoder</span> — Inpainting with 25% Masking
                    </h2>

                    <div class="content has-text-justified">
                        <p>
                            The Masked Autoencoder represents a <strong>self-supervised learning approach</strong> where
                            the model learns to reconstruct images from partially masked inputs. By randomly masking
                            <strong>25% of the input image</strong>, the autoencoder is forced to learn meaningful
                            representations that can infer the missing regions based on visible context and underlying
                            symmetry patterns.
                        </p>
                        <div class="notification is-warning is-light">
                            <strong>Key Insight:</strong> This approach tests whether the autoencoder truly understands
                            the symmetry structure of wallpaper groups by evaluating its ability to <strong>complete
                                masked regions</strong> consistently with the underlying pattern. Training time was
                            <strong>1h 26min</strong> with a Test MSE (Masked Inpainting) of <strong>0.1417</strong>.
                        </div>
                    </div>

                    <h3 class="title is-4">Architecture Details</h3>
                    <div class="content">
                        <pre><code>ConvAutoencoder(
  (encoder): Sequential(
    Conv2d(3, 32, kernel=3, stride=2, padding=1) → BatchNorm2d → LeakyReLU(0.2)
    Conv2d(32, 64, kernel=3, stride=2, padding=1) → BatchNorm2d → LeakyReLU(0.2)
    Conv2d(64, 128, kernel=3, stride=2, padding=1) → BatchNorm2d → LeakyReLU(0.2)
    Conv2d(128, 64, kernel=3, stride=2, padding=1) → BatchNorm2d → LeakyReLU(0.2)
  )  → Output: [B, 64, 16, 16] = 16,384 dimensions
  
  (decoder): Sequential(
    ConvTranspose2d(64, 128, kernel=4, stride=2, padding=1) → BatchNorm2d → ReLU
    ConvTranspose2d(128, 64, kernel=4, stride=2, padding=1) → BatchNorm2d → ReLU
    ConvTranspose2d(64, 32, kernel=4, stride=2, padding=1) → BatchNorm2d → ReLU
    ConvTranspose2d(32, 3, kernel=4, stride=2, padding=1) → Tanh
  )
)

Masking Strategy: Random 25% of image pixels masked during training</code></pre>
                    </div>

                    <h3 class="title is-4">Training Progress & Convergence</h3>
                    <div class="content has-text-justified">
                        <p>
                            Training was conducted for <strong>25 epochs</strong> before early stopping was triggered
                            (patience = 5). The model trained on <strong>76,500 samples</strong> with a mask ratio of
                            25%.
                        </p>
                    </div>
                    <div class="content">
                        <table class="table is-striped is-fullwidth">
                            <thead>
                                <tr>
                                    <th>Metric</th>
                                    <th>Value</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Total Epochs Trained</td>
                                    <td>25 (early stopping at epoch 20)</td>
                                </tr>
                                <tr>
                                    <td>Mask Ratio</td>
                                    <td><strong>25%</strong></td>
                                </tr>
                                <tr>
                                    <td>Final Training Loss</td>
                                    <td>0.040652</td>
                                </tr>
                                <tr>
                                    <td>Final Validation Loss</td>
                                    <td>0.041170</td>
                                </tr>
                                <tr>
                                    <td>Best Validation Loss</td>
                                    <td><strong>0.041058</strong></td>
                                </tr>
                                <tr>
                                    <td>Training Time</td>
                                    <td><strong>1 hour 26 minutes</strong></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="columns">
                        <div class="column is-8 is-offset-2">
                            <img src="./sources/mask_plot/training_history.png" alt="Training History"
                                style="width: 100%; border-radius: 8px;">
                            <p class="has-text-centered"><em>Training history showing loss convergence over epochs</em>
                            </p>
                        </div>
                    </div>

                    <h3 class="title is-4">Inpainting Reconstruction Comparison</h3>
                    <div class="content has-text-justified">
                        <p>
                            The following visualization shows how the model reconstructs masked regions. The comparison
                            demonstrates the model's ability to <strong>infer missing symmetry patterns</strong> from
                            visible context.
                        </p>
                    </div>
                    <div class="columns">
                        <div class="column is-full">
                            <img src="./sources/mask_plot/inpainting_reconstruction_comparison.png"
                                alt="Inpainting Reconstruction Comparison" style="width: 100%; border-radius: 8px;">
                            <p class="has-text-centered"><em>Original vs Masked vs Reconstructed comparison showing
                                    inpainting quality</em></p>
                        </div>
                    </div>

                    <h3 class="title is-4">Per-Class Reconstruction Comparison</h3>
                    <div class="columns">
                        <div class="column is-full">
                            <img src="./sources/mask_plot/per_class_reconstructions.png" alt="Per Class Reconstructions"
                                style="width: 100%; border-radius: 8px;">
                            <p class="has-text-centered"><em>Comprehensive per-class reconstruction examples showing
                                    how the model handles masked inpainting across all 17 symmetry groups</em></p>
                        </div>
                    </div>

                    <h3 class="title is-4">Latent Space Analysis - t-SNE & PCA</h3>
                    <div class="content has-text-justified">
                        <p>
                            PCA Analysis shows that <strong>first 2 components explain 21.6% of variance</strong>,
                            indicating a complex latent space. <strong>267 components</strong> are needed to explain 95%
                            of variance.
                        </p>
                    </div>
                    <div class="columns">
                        <div class="column">
                            <img src="./sources/mask_plot/tsne_latent_space.png" alt="t-SNE Masked AE"
                                style="width: 100%; border-radius: 8px;">
                            <p class="has-text-centered"><em>t-SNE visualization showing class separation in latent
                                    space</em></p>
                        </div>
                        <div class="column">
                            <img src="./sources/mask_plot/pca_latent_space.png" alt="PCA Masked AE"
                                style="width: 100%; border-radius: 8px;">
                            <p class="has-text-centered"><em>PCA projection (2D captures 21.6% of variance)</em></p>
                        </div>
                    </div>

                    <h3 class="title is-4">Error Distribution Analysis</h3>
                    <div class="content has-text-justified">
                        <p>
                            Detailed error distribution analysis reveals the inpainting quality across the test set.
                        </p>
                    </div>

                    <div class="columns">
                        <div class="column is-6">
                            <table class="table is-striped is-fullwidth">
                                <thead>
                                    <tr>
                                        <th>Statistic</th>
                                        <th>Value</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Total Test Samples</td>
                                        <td>355</td>
                                    </tr>
                                    <tr>
                                        <td>Mean Error</td>
                                        <td>0.141286</td>
                                    </tr>
                                    <tr>
                                        <td>Std Error</td>
                                        <td>0.086179</td>
                                    </tr>
                                    <tr>
                                        <td>Min Error</td>
                                        <td>0.013387</td>
                                    </tr>
                                    <tr>
                                        <td>Max Error</td>
                                        <td>0.607895</td>
                                    </tr>
                                    <tr>
                                        <td>Median Error</td>
                                        <td>0.118456</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="column is-6">
                            <img src="./sources/mask_plot/error_distribution.png" alt="Error Distribution"
                                style="width: 100%; border-radius: 8px;">
                            <p class="has-text-centered"><em>Error distribution across test set</em></p>
                        </div>
                    </div>

                    <h3 class="title is-4">Feature Maps</h3>
                    <div class="columns">
                        <div class="column">
                            <img src="./sources/mask_plot/feature_maps.png" alt="Feature Maps"
                                style="width: 100%; border-radius: 8px;">
                            <p class="has-text-centered"><em>Encoder feature map visualization</em></p>
                        </div>
                    </div>
                    <div class="columns">
                        <div class="column is-full">
                            <img src="./sources/mask_plot/feature_maps_detailed.png" alt="Feature Maps Detailed"
                                style="width: 100%; border-radius: 8px;">
                            <p class="has-text-centered"><em>Detailed individual channel feature maps</em></p>
                        </div>
                    </div>

                    <h3 class="title is-4">Latent Space Statistics</h3>
                    <div class="columns">
                        <div class="column is-6">
                            <table class="table is-striped is-fullwidth">
                                <thead>
                                    <tr>
                                        <th>Statistic</th>
                                        <th>Value</th>
                                        <th>Note</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Latent Vector Dimension</td>
                                        <td><strong>16,384</strong></td>
                                        <td>Same as Standard AE</td>
                                    </tr>
                                    <tr>
                                        <td>Mean Latent Value</td>
                                        <td>1.266538</td>
                                        <td>Not centered at 0</td>
                                    </tr>
                                    <tr>
                                        <td>Std Latent Value</td>
                                        <td>1.005986</td>
                                        <td>Higher variance</td>
                                    </tr>
                                    <tr>
                                        <td>Min Latent Value</td>
                                        <td>-1.898084</td>
                                        <td>Narrower range</td>
                                    </tr>
                                    <tr>
                                        <td>Max Latent Value</td>
                                        <td>13.003562</td>
                                        <td>Higher positive values</td>
                                    </tr>
                                    <tr>
                                        <td>Sparsity (% zeros)</td>
                                        <td>0.69%</td>
                                        <td>Low sparsity</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="column is-6">
                            <img src="./sources/mask_plot/latent_statistics.png" alt="Latent Statistics"
                                style="width: 100%; border-radius: 8px;">
                            <p class="has-text-centered"><em>Latent space statistics visualization</em></p>
                        </div>
                    </div>

                    <h3 class="title is-4">Class-wise Reconstruction Performance</h3>
                    <div class="content has-text-justified">
                        <p>
                            Test MSE Loss (Masked Inpainting): <strong>0.141689</strong> — Higher than standard
                            reconstruction due to the challenge of inpainting masked regions. The class-wise analysis
                            shows simpler symmetries (p1, pm) are easier to inpaint correctly.
                        </p>
                    </div>
                    <div class="content">
                        <table class="table is-striped is-fullwidth is-size-7">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Class</th>
                                    <th>Mean MSE</th>
                                    <th>Std</th>
                                    <th>Performance</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>p1</td>
                                    <td><strong>0.095938</strong></td>
                                    <td>±0.039598</td>
                                    <td style="color: green;">Best</td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>pm</td>
                                    <td>0.102631</td>
                                    <td>±0.051328</td>
                                    <td style="color: green;">Excellent</td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>pmg</td>
                                    <td>0.120116</td>
                                    <td>±0.050504</td>
                                    <td style="color: green;">Excellent</td>
                                </tr>
                                <tr>
                                    <td>4</td>
                                    <td>cm</td>
                                    <td>0.120755</td>
                                    <td>±0.054365</td>
                                    <td style="color: green;">Excellent</td>
                                </tr>
                                <tr>
                                    <td>5</td>
                                    <td>p3m1</td>
                                    <td>0.126557</td>
                                    <td>±0.055458</td>
                                    <td>Good</td>
                                </tr>
                                <tr>
                                    <td>6</td>
                                    <td>p3</td>
                                    <td>0.130303</td>
                                    <td>±0.065702</td>
                                    <td>Good</td>
                                </tr>
                                <tr>
                                    <td>7</td>
                                    <td>p31m</td>
                                    <td>0.137865</td>
                                    <td>±0.061311</td>
                                    <td>Good</td>
                                </tr>
                                <tr>
                                    <td>8</td>
                                    <td>p2</td>
                                    <td>0.141738</td>
                                    <td>±0.091288</td>
                                    <td>Good</td>
                                </tr>
                                <tr>
                                    <td>9</td>
                                    <td>pg</td>
                                    <td>0.144643</td>
                                    <td>±0.083859</td>
                                    <td>Average</td>
                                </tr>
                                <tr>
                                    <td>10</td>
                                    <td>pmm</td>
                                    <td>0.147325</td>
                                    <td>±0.083088</td>
                                    <td>Average</td>
                                </tr>
                                <tr>
                                    <td>11</td>
                                    <td>pgg</td>
                                    <td>0.147540</td>
                                    <td>±0.116432</td>
                                    <td>Average</td>
                                </tr>
                                <tr>
                                    <td>12</td>
                                    <td>p4g</td>
                                    <td>0.150296</td>
                                    <td>±0.055026</td>
                                    <td>Average</td>
                                </tr>
                                <tr>
                                    <td>13</td>
                                    <td>cmm</td>
                                    <td>0.154214</td>
                                    <td>±0.093846</td>
                                    <td>Below Average</td>
                                </tr>
                                <tr>
                                    <td>14</td>
                                    <td>p4m</td>
                                    <td>0.159313</td>
                                    <td>±0.060077</td>
                                    <td>Below Average</td>
                                </tr>
                                <tr>
                                    <td>15</td>
                                    <td>p6m</td>
                                    <td>0.170557</td>
                                    <td>±0.090561</td>
                                    <td>Below Average</td>
                                </tr>
                                <tr>
                                    <td>16</td>
                                    <td>p4</td>
                                    <td>0.185476</td>
                                    <td>±0.143337</td>
                                    <td style="color: orange;">Difficult</td>
                                </tr>
                                <tr>
                                    <td>17</td>
                                    <td>p6</td>
                                    <td>0.210967</td>
                                    <td>±0.108528</td>
                                    <td style="color: red;">Worst</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="notification is-info is-light">
                        <strong>Observation:</strong> The masked autoencoder shows similar performance ranking to the
                        standard autoencoder, with simpler symmetries (p1, pm) being easier to reconstruct. However,
                        the overall MSE is higher (~0.14 vs ~0.06) due to the additional challenge of inferring masked
                        regions. Complex rotational symmetries (p4, p6) remain the most challenging for inpainting.
                    </div>

                </div>
            </div>
        </div>
    </section>


    <footer class="footer">
        <div class="container">
            <div class="content has-text-centered">
                <a class="icon-link" href="./sources/mask_plot/">
                    <i class="fas fa-file-code"></i>
                </a>
                <a class="icon-link" href="#">
                    <i class="fab fa-github"></i>
                </a>
            </div>
            <div class="columns is-centered">
                <div class="column is-8">
                    <div class="content">
                        <p>
                            This website is licensed under a <a rel="license"
                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
                                Commons Attribution-ShareAlike 4.0 International License</a>.
                        </p>
                        <p>
                            Template adapted from the <a href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>
                            project page.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>


</body>

</html>